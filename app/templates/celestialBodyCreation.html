{% extends "base.html" %}
{% load static %}

{% block title %}Criar Corpo Celeste ‚Äî ViCosmuz{% endblock %}

{% block content %}
<style>
  body {
    background: radial-gradient(ellipse at bottom, #0b0d17 0%, #000000 100%);
    color: #f0f4ff;
    font-family: "Poppins", sans-serif;
  }

  .container {
    padding: 80px 20px;
    text-align: center;
  }

  .card-space {
    background: rgba(255,255,255,0.05);
    border-radius: 20px;
    padding: 50px 40px;
    box-shadow: 0 0 25px rgba(255,255,255,0.1);
    backdrop-filter: blur(10px);
    transition: all 0.3s ease;
  }

  .card-space:hover {
    box-shadow: 0 0 35px rgba(96,165,250,0.3);
  }

  .form-select, input[type="text"], input[type="number"], input[type="date"], textarea {
    background: rgba(255,255,255,0.07);
    color: #f0f4ff;
    border: 1px solid rgba(96,165,250,0.4);
    border-radius: 10px;
    padding: 10px 12px;
    width: 100%;
    margin-bottom: 15px;
    transition: all 0.3s ease;
    font-size: 1rem;
  }

  input:focus, textarea:focus, .form-select:focus {
    outline: none;
    border-color: #60a5fa;
    box-shadow: 0 0 12px #3b82f6;
  }

  label {
    display: block;
    margin-bottom: 6px;
    font-weight: 500;
    text-align: left;
  }

  .fadeIn {
    animation: fadeIn 0.5s ease forwards;
  }

  @keyframes fadeIn {
    from {opacity:0; transform:translateY(10px);}
    to {opacity:1; transform:translateY(0);}
  }

  .btn-galaxy, .btn-star, .btn-planet {
    display: inline-block;
    border: none;
    border-radius: 10px;
    padding: 12px 28px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-top: 10px;
  }

  .btn-galaxy {
    background: linear-gradient(90deg, #3b82f6, #9333ea);
    color: #fff;
  }

  .btn-star {
    background: linear-gradient(90deg, #ffb347, #ffcc33);
    color: #111;
  }

  .btn-star:hover {
    transform: scale(1.05);
    box-shadow: 0 0 25px rgba(255, 215, 100, 0.25);
  }

  #starForm,
  #starForm label,
  #starForm h4,
  #starForm input,
  #starForm textarea,
  #starForm select,
  #starForm p {
    color: #111 !important;
  }

  #starForm input,
  #starForm textarea,
  #starForm select {
    background: rgba(255,255,255,0.9);
    border: 1px solid #f6ad55;
  }

  #starForm input::placeholder,
  #starForm textarea::placeholder {
    color: #555;
  }

  .btn-planet {
    background: linear-gradient(90deg, #2193b0, #6dd5ed);
    color: #fff;
  }

  .btn-galaxy:hover, .btn-planet:hover {
    transform: scale(1.05);
    box-shadow: 0 0 25px rgba(255,255,255,0.3);
  }

  .form-header {
    font-size: 1.6rem;
    margin-bottom: 20px;
    font-weight: 600;
  }
</style>

<div class="container">
  <div class="card-space mx-auto" style="max-width: 800px;">
    <h2 id="pageTitle" class="mb-4 fw-bold">Criar Corpo Celeste</h2>

    <form method="POST" enctype="multipart/form-data" id="celestialBodyForm">
      {% csrf_token %}

      <div class="mb-4">
        <label for="objectType" class="fw-semibold mb-2">üå† Escolha o tipo de corpo celeste</label>
        <select id="objectType" name="objectType" class="form-select mx-auto w-50" required>
          <option value="">Selecione...</option>
          <option value="galaxy" {% if selectedType == 'galaxy' %}selected{% endif %}>üåå Gal√°xia</option>
          <option value="star" {% if selectedType == 'star' %}selected{% endif %}>‚≠ê Estrela</option>
          <option value="planet" {% if selectedType == 'planet' %}selected{% endif %}>ü™ê Planeta</option>
        </select>
      </div>

      <div id="galaxyForm" class="bodyForm" style="display:none;">
        <h4 class="form-header text-info">Dados da Gal√°xia</h4>
        {{ galaxyForm.as_p }}
        <button type="submit" class="btn-galaxy">Registrar Gal√°xia</button>
      </div>

      <div id="starForm" class="bodyForm" style="display:none;">
        <h4 class="form-header" style="color:#111;">Dados da Estrela</h4>
        {{ starForm.as_p }}
        <button type="submit" class="btn-star">Registrar Estrela</button>
      </div>

      <div id="planetForm" class="bodyForm" style="display:none;">
        <h4 class="form-header text-primary">Dados do Planeta</h4>
        {{ planetForm.as_p }}
        <button type="submit" class="btn-planet">Registrar Planeta</button>
      </div>
    </form>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener("DOMContentLoaded", () => {
  const select = document.getElementById("objectType");
  const title = document.getElementById("pageTitle");

  if (!select || !title) {
    console.warn("‚ö†Ô∏è ViCosmuz: Missing select or title element, script aborted.");
    return;
  }

  const forms = {
    galaxy: document.getElementById("galaxyForm"),
    star: document.getElementById("starForm"),
    planet: document.getElementById("planetForm"),
  };

  const themes = {
    galaxy: { title: "Criar Gal√°xia", bg: "radial-gradient(circle at top left, #0b0d17, #1e1e2f)" },
    star: { title: "Criar Estrela", bg: "radial-gradient(circle at top right, #ffb347, #ffcc33)" },
    planet: { title: "Criar Planeta", bg: "linear-gradient(120deg, #2193b0, #6dd5ed)" },
  };

  function showForm(type) {
    // Hide all forms
    Object.values(forms).forEach(f => {
      if (f) f.style.display = "none";
    });

    if (type && forms[type]) {
      const theme = themes[type];
      document.body.style.background = theme.bg || "#0b0d17";
      title.textContent = theme.title;
      title.style.color = type === "star" ? "#111" : "#f0f4ff";

      forms[type].style.display = "block";
      forms[type].classList.add("fadeIn");
    } else {
      document.body.style.background =
        "radial-gradient(ellipse at bottom, #0b0d17 0%, #000000 100%)";
      title.textContent = "Criar Corpo Celeste";
      title.style.color = "#f0f4ff";
    }
  }

  // Event listeners
  select.addEventListener("change", e => showForm(e.target.value));

  // Initialize state after DOM is ready
  setTimeout(() => {
    showForm(select.value);
  }, 0);
});
</script>
{% endblock %}

